# **Car QR Service**

Це мій перший навчальний проєкт на FastAPI, мета якого — створити корисний сервіс, 
вивчити FastAPI та отримати задоволення від процесу.

## **Для розробників**

Ця інструкція допоможе вам налаштувати проєкт локально для розробки.

### **1. Початкове налаштування**

Вимоги:

Встановлений Python 3.10+

Встановлений менеджер пакетів Poetry (рекомендовано останніх версій 2.х+)

Кроки:

Клонуйте репозиторій:

`git clone <URL вашого репозиторію>`
`cd car_qr_service`

Встановіть залежності:
Ця команда створить віртуальне оточення та встановить усі необхідні бібліотеки з файлу pyproject.toml.

Налаштуйте змінні оточення:

Створіть файл .env у кореневій директорії проєкту (можна просто скопіювати .env.example, якщо він є, або створити з нуля).
Найпростіше це зробити, скопіювавши файл-приклад:

`cp .env.example .env`

Для SQLite (основна гілка):
Файл .env має містити лише секретний ключ для JWT. Інші налаштування для бази даних не потрібні, оскільки config.py за замовчуванням налаштований на sqlite+aiosqlite:///./car_qr.db.

Для PostgreSQL (гілка deployment):
Файл .env має також містити ваші дані для підключення до Postgres (USER, PASSWORD, SERVER, PORT, DB).

Згенеруйте секретний ключ:
Виконайте команду і скопіюйте результат у файл .env:

`poetry run python -c "import secrets; print(secrets.token_hex(32))"`

Відкрийте файл .env і вставте згенерований ключ у змінну **JWT_SECRET_KEY**.

.env має виглядати якось так:

JWT_SECRET_KEY=ваш_згенерований_ключ

JWT_ALGORITHM=HS256

ACCESS_TOKEN_EXPIRE_MINUTES=30

### **2. Налаштування бази даних (Alembic)**

Важливо: Тека alembic (включно з файлом env.py та підпапкою versions/ з усіма файлами міграцій) та файл alembic.ini у цьому репозиторії вже повністю налаштовані і мають бути в системі контролю версій (Git).

НЕ ВИКОНУЙТЕ команду 

`poetry run alembic init -t async alembic`

Ця команда призначена для створення проєкту з нуля і вона перезапише ваші правильні налаштування порожніми шаблонами, що призведе до помилок (як-от NoSuchModuleError).

Все, що вам потрібно зробити, — це застосувати міграції які вже існують, 
щоб створити таблиці у вашій базі даних.

Застосування міграцій:
Щоб створити всі таблиці в базі даних (car_qr.db), виконайте:

`poetry run alembic upgrade head`

Ця команда автоматично прочитає налаштований alembic/env.py, знайде DB_URL у вашому config.py і створить базу даних.

### **3. Запуск застосунку**

Для запуску веб-сервера виконайте команду:

`poetry run uvicorn src.car_qr_service.main:app --reload --port 8001`

_**--reload**_ автоматично перезавантажить сервер при зміні коду.

**_--port 8001_** вказує порт для запуску.

Після запуску API буде доступний за адресою http://127.0.0.1:8001, 
а інтерактивна документація — http://127.0.0.1:8001/docs.

### **4. Запуск тестів**

Для запуску всіх автоматичних тестів виконайте команду:

`poetry run pytest`
